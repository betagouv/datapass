{"version":3,"file":"scheme.module.js","sources":["../../.config/config.js","../../src/core/api.js","../../src/scheme/script/scheme/scheme-value.js","../../src/scheme/script/scheme/scheme-attribute.js","../../src/scheme/script/scheme/scheme-theme.js","../../src/scheme/script/scheme/scheme-emission.js","../../src/core/script/api/utilities/propertie.js","../../src/scheme/script/scheme/scheme.js","../../src/scheme/script/scheme/scheme-selector.js","../../src/scheme/index.js","../../src/scheme/main.js"],"sourcesContent":["const config = {\r\n  prefix: 'fr',\r\n  namespace: 'dsfr',\r\n  organisation: '@gouvfr',\r\n  version: '1.2.1'\r\n};\r\n\r\nexport default config;\r\n","import config from './config.js';\nconst api = window[config.namespace];\nexport default api;\n","export const SchemeValue = {\n  SYSTEM: 'system',\n  LIGHT: 'light',\n  DARK: 'dark'\n};\n","import api from '../../api';\n\nexport const SchemeAttribute = {\n  THEME: api.ns.attr('theme'),\n  SCHEME: api.ns.attr('scheme'),\n  TRANSITION: api.ns.attr('transition')\n};\n","export const SchemeTheme = {\n  LIGHT: 'light',\n  DARK: 'dark'\n};\n","import api from '../../api';\n\nexport const SchemeEmission = {\n  SCHEME: api.ns.emission('scheme', 'scheme'),\n  THEME: api.ns.emission('scheme', 'theme'),\n  ASK: api.ns.emission('scheme', 'ask')\n};\n","/**\n * Copy properties from multiple sources including accessors.\n * source : https://developer.mozilla.org/fr/docs/Web/JavaScript/Reference/Global_Objects/Object/assign#copier_des_accesseurs\n *\n * @param {object} [target] - Target object to copy into\n * @param {...objects} [sources] - Multiple objects\n * @return {object} A new object\n *\n * @example\n *\n *     const obj1 = {\n *        key: 'value'\n *     };\n *     const obj2 = {\n *        get function01 () {\n *          return a-value;\n *        }\n *        set function01 () {\n *          return a-value;\n *        }\n *     };\n *     completeAssign(obj1, obj2)\n */\nconst completeAssign = (target, ...sources) => {\n  sources.forEach(source => {\n    const descriptors = Object.keys(source).reduce((descriptors, key) => {\n      descriptors[key] = Object.getOwnPropertyDescriptor(source, key);\n      return descriptors;\n    }, {});\n\n    Object.getOwnPropertySymbols(source).forEach(sym => {\n      const descriptor = Object.getOwnPropertyDescriptor(source, sym);\n      if (descriptor.enumerable) {\n        descriptors[sym] = descriptor;\n      }\n    });\n    Object.defineProperties(target, descriptors);\n  });\n  return target;\n};\n\nexport { completeAssign };\n","import api from '../../api.js';\nimport { SchemeValue } from './scheme-value.js';\nimport { SchemeAttribute } from './scheme-attribute.js';\nimport { SchemeTheme } from './scheme-theme.js';\nimport { SchemeEmission } from './scheme-emission.js';\nimport { completeAssign } from '../../../core/script/api/utilities/propertie';\n\nclass Scheme extends api.core.Instance {\n  constructor () {\n    super(false);\n  }\n\n  static get instanceClassName () {\n    return 'Scheme';\n  }\n\n  init () {\n    this.changing = this.change.bind(this);\n\n    if (this.hasAttribute(SchemeAttribute.TRANSITION)) {\n      this.removeAttribute(SchemeAttribute.TRANSITION);\n      this.request(this.restoreTransition.bind(this));\n    }\n\n    const scheme = localStorage.getItem('scheme');\n    const schemeAttr = this.getAttribute(SchemeAttribute.SCHEME);\n\n    switch (scheme) {\n      case SchemeValue.DARK:\n      case SchemeValue.LIGHT:\n      case SchemeValue.SYSTEM:\n        this.scheme = scheme;\n        break;\n\n      default:\n        switch (schemeAttr) {\n          case SchemeValue.DARK:\n            this.scheme = SchemeValue.DARK;\n            break;\n\n          case SchemeValue.LIGHT:\n            this.scheme = SchemeValue.LIGHT;\n            break;\n\n          default:\n            this.scheme = SchemeValue.SYSTEM;\n        }\n    }\n\n    this.addAscent(SchemeEmission.ASK, this.ask.bind(this));\n    this.addAscent(SchemeEmission.SCHEME, this.apply.bind(this));\n  }\n\n  get proxy () {\n    const scope = this;\n\n    const proxyAccessors = {\n      get scheme () {\n        return scope.scheme;\n      },\n      set scheme (value) {\n        scope.scheme = value;\n      }\n    };\n\n    return completeAssign(super.proxy, proxyAccessors);\n  }\n\n  restoreTransition () {\n    this.setAttribute(SchemeAttribute.TRANSITION, '');\n  }\n\n  ask () {\n    this.descend(SchemeEmission.SCHEME, this.scheme);\n  }\n\n  apply (value) {\n    this.scheme = value;\n  }\n\n  get scheme () {\n    return this._scheme;\n  }\n\n  set scheme (value) {\n    if (this._scheme === value) return;\n    this._scheme = value;\n    switch (value) {\n      case SchemeValue.SYSTEM:\n        this.listenPreferences();\n        break;\n\n      case SchemeValue.DARK:\n        this.unlistenPreferences();\n        this.theme = SchemeTheme.DARK;\n        break;\n\n      case SchemeValue.LIGHT:\n        this.unlistenPreferences();\n        this.theme = SchemeTheme.LIGHT;\n        break;\n\n      default:\n        this.scheme = SchemeValue.SYSTEM;\n        return;\n    }\n\n    this.descend(SchemeEmission.SCHEME, value);\n    localStorage.setItem('scheme', value);\n    this.setAttribute(SchemeAttribute.SCHEME, value);\n  }\n\n  get theme () {\n    return this._theme;\n  }\n\n  set theme (value) {\n    if (this._theme === value) return;\n    switch (value) {\n      case SchemeTheme.LIGHT:\n      case SchemeTheme.DARK:\n        this._theme = value;\n        this.setAttribute(SchemeAttribute.THEME, value);\n        this.descend(SchemeEmission.THEME, value);\n        break;\n    }\n  }\n\n  listenPreferences () {\n    if (this.isListening) return;\n    this.isListening = true;\n    this.mediaQuery = window.matchMedia('(prefers-color-scheme: dark)');\n    this.mediaQuery.addEventListener('change', this.changing);\n    this.change();\n  }\n\n  unlistenPreferences () {\n    if (!this.isListening) return;\n    this.isListening = false;\n    this.mediaQuery.removeEventListener('change', this.changing);\n    this.mediaQuery = null;\n  }\n\n  change () {\n    if (!this.isListening) return;\n    this.theme = this.mediaQuery.matches ? SchemeTheme.DARK : SchemeTheme.LIGHT;\n  }\n\n  mutate (attributeNames) {\n    if (attributeNames.indexOf(SchemeAttribute.SCHEME) > -1) this.scheme = this.getAttribute(SchemeAttribute.SCHEME);\n    if (attributeNames.indexOf(SchemeAttribute.THEME) > -1) this.theme = this.getAttribute(SchemeAttribute.THEME);\n  }\n\n  dispose () {\n    this.unlistenPreferences();\n  }\n}\n\nexport { Scheme };\n","import api from '../../api.js';\n\nexport const SchemeSelector = {\n  SCHEME: `:root${api.ns.attr.selector('theme')}, :root${api.ns.attr.selector('scheme')}`,\n  SWITCH_THEME: api.ns.selector('switch-theme'),\n  RADIO_BUTTONS: `input[name=\"${api.ns('radios-theme')}\"]`\n};\n","import api from './api.js';\nimport { Scheme } from './script/scheme/scheme.js';\nimport { SchemeValue } from './script/scheme/scheme-value.js';\nimport { SchemeSelector } from './script/scheme/scheme-selector.js';\nimport { SchemeEmission } from './script/scheme/scheme-emission.js';\nimport { SchemeTheme } from './script/scheme/scheme-theme.js';\n\napi.scheme = {\n  Scheme: Scheme,\n  SchemeValue: SchemeValue,\n  SchemeSelector: SchemeSelector,\n  SchemeEmission: SchemeEmission,\n  SchemeTheme: SchemeTheme\n};\n\nexport default api;\n","import api from './index.js';\n\napi.register(api.scheme.SchemeSelector.SCHEME, api.scheme.Scheme);\n\nexport default api;\n"],"names":[],"mappings":"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"}